import{a as A,d as B,f as M,g as U,h as _}from"./chunk-XP46ZQI7.js";import{g as W,h as $}from"./chunk-NOAR4FBC.js";import{$a as o,Ba as b,Cb as E,Eb as P,Fb as j,Ga as w,Gb as G,Ka as O,Ra as I,Ta as a,Ua as n,a as p,ab as F,b as f,bb as S,cb as C,e as l,h as v,hb as d,ib as g,jb as y,xa as r}from"./chunk-WRYOPP3C.js";function L(s,t){if(s&1&&(a(0,"div",11)(1,"div",12)(2,"div",4)(3,"h5",5),o(4),n(),a(5,"p",6),o(6),d(7,"date"),n(),a(8,"p",6),o(9),n()()()()),s&2){let e=t.$implicit;r(4),F(e.name||"Untitled Game"),r(2),S("Date: ",g(7,3,e.date==null?null:e.date.toDate()),""),r(3),S("Score: ",e.totalPoints,"")}}var N=class s{constructor(t,e){this.authService=t;this.firestore=e}user=null;userSub;games$=new v;today=new Date;ngOnInit(){this.userSub=this.authService.currentUser.subscribe(t=>{this.user=t}),this.loadGamesWithScores()}ngOnDestroy(){this.userSub&&this.userSub.unsubscribe()}loadGamesWithScores(){return l(this,null,function*(){let t=B(this.firestore,"games"),i=(yield _(t)).docs.map(c=>p({id:c.id},c.data())),u=yield this.enrichGamesWithScore(i);this.games$=new v(c=>c.next(u))})}enrichGamesWithScore(t){return l(this,null,function*(){return yield Promise.all(t.map(i=>l(this,null,function*(){let u=M(this.firestore,"games",i.id),m=(yield U(u)).data();if(console.log("Fetched game data:",m),!m||!m.stats)return f(p({},i),{totalPoints:0});let D=Object.values(m.stats);console.log("Stats object for game",i.id,":",D);let R=D.reduce((T,h)=>{let x=typeof h=="object"&&"points"in h?h.points:0;return T+(typeof x=="number"?x:0)},0);return f(p({},i),{totalPoints:R})})))})}static \u0275fac=function(e){return new(e||s)(b($),b(A))};static \u0275cmp=w({type:s,selectors:[["app-dashboard"]],decls:21,vars:11,consts:[[1,"container","mt-5"],[1,"row","justify-content-center","mb-4"],[1,"col-md-6"],[1,"card","bg-light","shadow","text-center"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"row","mb-4","justify-content-center"],[1,"card","text-white","bg-dark","shadow","text-center"],[1,"card-text","fs-5"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[1,"card"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),o(6,"Welcome to the Sports Dashboard"),n(),a(7,"p",6),o(8,"Live game data and user info will appear below."),n()()()()(),a(9,"div",7)(10,"div",2)(11,"div",8)(12,"div",4)(13,"h4",5),o(14,"Live Game Date"),n(),a(15,"p",9),o(16),d(17,"date"),d(18,"date"),n()()()()(),O(19,L,10,5,"div",10),d(20,"async"),n()),e&2&&(r(16),C("",y(17,3,i.today,"fullDate")," - ",y(18,6,i.today,"shortTime"),""),r(3),I("ngForOf",g(20,9,i.games$)))},dependencies:[W,G,E,P,j],encapsulation:2})};export{N as DashboardComponent};
